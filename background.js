const e=a;function t(t,n){const o=e;try{let c=t;if(n[o(202)](o(274)))!t[o(202)](o(274))&&(c=o(236)+t);else try{const e=new URL(t[o(202)](o(274))?t:o(236)+t);c=e[o(264)]+e[o(275)]}catch(a){c=t}let s=n;if(n[o(202)]("://"))try{const e=new URL(n);s=e[o(264)]+e[o(275)]}catch(r){s=n}return function(t){const n=e;let o=t[n(243)](/[.+^${}()|[\]\\]/g,n(193))[n(243)](/\*\*/g,n(228))[n(243)](/\*/g,n(172))[n(243)](/___DOUBLE_STAR___/g,".*")[n(243)](/\?/g,".");return new RegExp("^"+o+"$")}(s)[o(244)](c)}catch(c){return console[o(270)](o(205),c),!1}}async function n(t,n,o,r){const c=e;try{const i=await chrome.tabs[c(240)](n,{format:c(192)}),l=await async function(t,n){const o=e,a=await fetch(t),r=await a[o(267)](),c=await createImageBitmap(r);n[o(271)];const s=n[o(168)],i=n[o(215)],l=(n[o(180)]||60)/100,d=c[o(245)]/s,p=c[o(213)]/i,u=n.x*d,m=n.y*p,h=c.width*l,g=c[o(213)]*l;let w=u-h/2,f=m-g/2;w<0&&(w=0);f<0&&(f=0);w+h>c.width&&(w=c[o(245)]-h);f+g>c[o(213)]&&(f=c[o(213)]-g);const I=new OffscreenCanvas(h,g);return I[o(203)]("2d")[o(195)](c,w,f,h,g,0,0,h,g),await I[o(208)]({type:o(196)})}(i,t),d=await(s=l,new Promise((e,t)=>{const n=a,o=new FileReader;o.onload=()=>e(o[n(224)]),o[n(251)]=t,o[n(182)](s)})),p=(t[c(269)]||c(263))[c(243)](/[\\/:*?"<>|]/g,"_")[c(249)](),u=c(229)+p,m=(t[c(218)]||c(217))[c(243)](/[\\/:*?"<>|]/g,"_")[c(249)]()[c(187)](0,50);let h=(t[c(200)]||c(262)).replace(/[\\/:*?"<>|]/g,"_");h=h.replace(/\s+/g," ")[c(249)]().substring(0,50),h||(h=c(167));const g=u+c(220)+m+"_"+h+c(273);chrome[c(233)].download({url:d,filename:g,saveAs:!1},e=>{const t=c;if(chrome[t(169)].lastError)return void console[t(270)](t(185),chrome.runtime.lastError[t(242)]);const n={downloadId:e,filename:g,domain:p,timestamp:Date[t(183)](),thumbnailUrl:d,dataUrl:d};chrome[t(188)][t(252)].get([t(248)],e=>{const o=t,a=e[o(248)]||[];a.push(n),chrome.storage[o(252)][o(212)]({downloadedImages:a}),chrome[o(169)][o(175)]({action:o(194),imageInfo:n})[o(266)](()=>{})}),r&&o&&chrome.tabs[t(175)](o,{action:"captureComplete"}).catch(()=>{})})}catch(i){i.message&&i.message.includes(c(173))?console[c(237)](c(261)):console.error(c(241),i),r&&o&&chrome[c(268)][c(175)](o,{action:c(178)})[c(266)](()=>{})}var s}function o(){const e=["downloadedImages","trim","url","onerror","local","disabledUrls","312855JkdiKe","Side panel not supported, will use popup instead","basic","getBadgeText","capture","config","Side panel API not available, using popup","Screenshot skipped: Page cannot be captured (restricted page or tab switched too fast)","element","unknown_domain","hostname","45wHIleG","catch","blob","tabs","domain","error","devicePixelRatio","loadImage",".png","://","pathname","dataUrl","empty","viewportWidth","runtime","index.html","install","[^/]*","Cannot access contents","3501HbMWnE","sendMessage","Failed to load image:","tab","captureComplete","action","cropScale","2644RajunL","readAsDataURL","now","addListener","Download failed:","Failed to get file icon","substring","storage","notifications","770kvOSbT","Auto Capture 已安装","png","\\$&","imageDownloaded","drawImage","image/png","onInstalled","308979FsoiJk","setPopup","clickedText","open","includes","getContext","onMessage","URL matching error:","then","downloadId","convertToBlob","onClicked","391688VTmPoY","1294867ynKemI","set","height","18hRvgmR","viewportHeight","create","untitled","title","当前页面在禁用列表中，跳过截图","/auto_capture_","getFileIcon","windowId","filename","result","1704224vpFFVm","sidePanel","get","___DOUBLE_STAR___","auto_capture_","reason","isArray","needCallback","downloads","lastError","some","https://","log","length","find","captureVisibleTab","Capture processing failed:","message","replace","test","width","payload","954665vpkcrc"];return(o=function(){return e})()}function a(e,t){e-=167;return o()[e]}(function(){const e=a,t=o();for(;;)try{if(671414===-parseInt(e(247))/1+parseInt(e(225))/2+-parseInt(e(174))/3*(parseInt(e(181))/4)+parseInt(e(254))/5*(-parseInt(e(214))/6)+-parseInt(e(211))/7+-parseInt(e(210))/8*(parseInt(e(265))/9)+parseInt(e(190))/10*(parseInt(e(198))/11))break;t.push(t.shift())}catch(n){t.push(t.shift())}})(),chrome.runtime[e(197)][e(184)](t=>{const n=e;t[n(230)]===n(171)&&chrome.action[n(257)]({},e=>{const t=n;chrome[t(189)][t(216)]({type:t(256),iconUrl:"icons/icon48.png",title:t(191),message:'请右键点击扩展图标，选择"固定"以将其添加到工具栏，方便快速使用！'})})}),chrome[e(179)][e(209)][e(184)](t=>{const n=e;chrome[n(226)]&&"function"==typeof chrome[n(226)][n(201)]?chrome[n(226)].open({windowId:t.windowId})[n(266)](e=>{const t=n;console[t(237)](t(255)),chrome[t(179)].setPopup({popup:t(170)})}):(console[n(237)](n(260)),chrome.action[n(199)]({popup:"index.html"}))}),chrome[e(169)][e(204)][e(184)]((o,r,c)=>{var s,i;const l=e;if(o[l(179)]===l(258)){if(r.tab&&r[l(177)][l(250)])return chrome.storage[l(252)][l(227)]([l(259)],a=>{var c,s;const i=l,d=(a[i(259)]||{})[i(253)]||[];if(function(n,o){const a=e;return!(!o||!Array[a(231)](o)||0===o[a(238)])&&o[a(235)](e=>t(n,e))}(r[i(177)][i(250)],d))return void console[i(237)](i(219));const p=(null==(c=r.tab)?void 0:c[i(222)])??null,u=(null==(s=r[i(177)])?void 0:s.id)??null,m=o[i(232)]||!1;n(o[i(246)],p,u,m)}),!0;{const e=(null==(s=r.tab)?void 0:s[l(222)])??null,t=(null==(i=r[l(177)])?void 0:i.id)??null,a=o[l(232)]||!1;n(o[l(246)],e,t,a)}}else if(o.action===l(272))return async function(e){return new Promise((t,n)=>{const o=a;chrome[o(188)][o(252)][o(227)]([o(248)],a=>{const r=o,c=(a.downloadedImages||[])[r(239)](t=>t[r(207)]===e);c&&c[r(276)]?t(c[r(276)]):chrome[r(233)][r(221)](e,{size:512},e=>{const o=r;chrome[o(169)][o(234)]?n(chrome[o(169)].lastError):e?t(e):n(new Error(o(186)))})})})}(o[l(207)],o[l(223)])[l(206)](e=>{c({dataUrl:e})}).catch(e=>{const t=l;console[t(270)](t(176),e),c({error:e[t(242)]})}),!0});
